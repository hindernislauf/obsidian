- ### 기본 명령어
	- ls : 해당 디렉토리의 파일 목록을 표시
		- ls /주소/주소/주소... : 해당 주소 디렉토리의 목록을 표시
		- ls -a : 숨김 파일 포함 표시
		- ls -l : 목록을 자세히 표시 (파일 소유자 파일 크기 생성(수정)날짜 등 모든 정보 표시)
	- cd : 디렉토리 이동 명령어
		- cd .. : 바로 상위의 디렉토리로 이동, '..'은 현재 디렉토리의 부모 디렉토리를 의미
		- cd /주소/주소 : 해당 경로의 디렉토리로 이동(절대경로)
		- cd ../주소/주소 : 상대경로로 이동, 현재 디렉토리의 상위로 이동후  해당 주소로 
		**. 은 현재 디렉토리 .. 은 상위 디렉토리**
	- pwd : 현재 디렉토리의 전체 경로를 화면에 표시
	- rm : 파일이나 디렉토리를 삭제, 파일이나 디렉토리를 삭제할때는 권한이 필요, 단 root사용자는 모든 권한이 있으므로 사용에 제약이 없다. (root 사용자 비추)
		- rm abc.txt : 해당 파일을 삭제(내부적으로는 'rm -i'로 연결됨)
		- rm -i abc.txt : 삭제시 정말 삭제할 지 확인하는 메시지를 표시
		- rm -f abc.txt : 삭제시 확인하지 않고 바로 삭제 (f는 Force의 약자)
		- rm -r abc : 해당 디렉토리를 삭제(r은 Recursive의 약자)
		- rm -rf abc : r + f, 해당 디렉토리를 삭제 and 하위 디렉토리를 강제로 전부 삭제(주의해서 사용 해야함)
	- cp : 파일이나 디렉토리를 복사, 새로 복사한 파일은 복사한 사용자의 소유, 명령을 실행하는 사용자는 해당 파일의 읽기 권한이 필요함
		- cp abc.txt bcd.txt : abc 을 bcd로 이름을 바꿔서 복사
		- cp -r abc bcd : 디렉토리 명을 변경하면서 복사
	- touch : 크기가 0인 새 파일을 생성하거나 생성된 파일이 존재한다면 파일의 최종 수정 시간을 변경
		- touch abc.txt : 파일이 없는경우 abc.txt라는 빈 파일을 생성 or abc.txt파일이 있는 경우 최종 수정 시간을 현재 시각으로 변경
	- mv : 파일이나 디렉토리의 이름을 변경하거나 다른 디렉토리로 옮길 때 사용
		- mv abc.txt /주소/주소/... : 해당 파일을 해당 경로의 디렉토리로 이동
		- mv aaa bbb ccc ddd : aaa, bbb, ccc 파일을 /ddd 디렉터리로 이동
		- mv abc.txt bbb.txt : abc.txt의 이름을 bbb.txt로 변경해서 이동
	- 
- ### pyenv
	- 리눅스에서 파이썬 가상환경을 다루는 툴
	- 윈도우 에서 아나콘다 추천 => conda
	- 리눅스 or 맥 계열에서는 pyenv 추천
	
	```
	sudo apt-get update; sudo apt-get install make build-essential libssl-dev zlib1g-dev \
	
	libbz2-dev libreadline-dev libsqlite3-dev wget curl llvm \
	
	libncursesw5-dev xz-utils tk-dev libxml2-dev libxmlsec1-dev libffi-dev liblzma-dev
	```
	
	```
	curl https://pyenv.run | bash
	```
	
	```
	# vim .bashrc 최 하단에 복붙
	export PYENV_ROOT="$HOME/.pyenv"
	[[ -d $PYENV_ROOT/bin ]] && export PATH="$PYENV_ROOT/bin:$PATH"
	eval "$(pyenv init -)"
	eval "$(pyenv virtualenv-init -)"
	```
	
	```
	# 쉘 재시작
	exec $SHELL 
	```
	
	```
	# pyenv 설치 확인
	pyenv
	```
	
	```
	# pyenv 가상환경 생성
	pyenv install --list
	.
	.
	3.11.9 # -> 이거 설치
	.
	.
	```
	
	```
	# 파이썬 3.11.9 설치
	pyenv install 3.11.9
	```
	
	```
	# 가상환경 확인
	pyenv versions
	```
	
	```
	# pyenv 가상 환경 생성
	pyenv virtualenv 3.11.9 py3_11_9
	```
	
	```
	# 가상 환경 실행
	pyenv activate py3_11_9
	
	# 가상 환경 종료
	pyenv deactivate
	```
	
	```
	# pyenv 필요한 라이브러리 설치 (가상 환경 실행 후!!)
	 pip install numpy
	 pip install pandas
	 pip install scikit-learn
	 pip install flask
	 pip install gunicorn
	 pip install psycopg2-binary
	```
	
	```
	python
	
	import 라이브러리 이름
	
	exit(), Ctrl-D, quit()
	```
	
	```
	vim 파일명
	~내용~
	
	python 파일명
	```
	
	```
	# pytest02.py 파일을 백그라운드로 실행
	nohup python pytest02.py > /dev/null 2>&1 &
	
	# 결과
	[1] 21816 # 프로세스 번호
	```
	- nohup : "no hang up(전화 끊지마)"의 약자, 프로세스를 실행한 터미널 세션 연결이 끊기더라도 프로세스를 계속 작동시키는 명령어
	- > : 결과를 파일로 저장
	- /dev/null : 윈도우에서 휴지통의 개념, 데이터를 이곳으로 보내면 데이터는 실제로 저장되지 않고 삭제됨 (출력 무시할 때 사용)
	- 2 : 표준 에러
	- >& : 리다이렉션 (2>&1 : 표준 에러를 표준 출력으로 리다이렉션)
	- 1 : 표준 출력
	- & : 백그라운드로 실행
	
	```
	# 프로세스 확인
	ps -ef | grep pytest02
	```
	
	```
	#프로세스 종료
	kill -9 프로세스 번호 (프로세스 번호는 꼭 복붙!! 오타나면 큰일남!!)
	
	# 결과
	[1]+  Killed                  nohup python pytest02.py > /dev/null 2>&1
	```
- ### PostgreSQL
	- My SQL : 오픈소스, 무료 -> IT회사, 개발자 집단
	- MS SQL : Microsoft -> 게임회사, 제조업
	- Oracle : 유료 -> 비 IT 회사에서 데이터베이스 사용시, 항공사, 금융권, 호텔, 제조업
	- maria db
	- postgreSQL
	
	- 설치
		https://www.postgresql.org/download/linux/ubuntu/
		```
		# Import the repository signing key:
		sudo apt install curl ca-certificates  
		sudo install -d /usr/share/postgresql-common/pgdg  
		sudo curl -o /usr/share/postgresql-common/pgdg/apt.postgresql.org.asc --fail https://www.postgresql.org/media/keys/ACCC4CF8.asc
		
		# Create the repository configuration file:
		sudo sh -c 'echo "deb [signed-by=/usr/share/postgresql-common/pgdg/apt.postgresql.org.asc] https://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main" > /etc/apt/sources.list.d/pgdg.list'
		
		# Update the package lists:
		sudo apt update
		
		# Install the latest version of PostgreSQL:
		# If you want a specific version, use 'postgresql-16' or similar instead of 'postgresql'
		sudo apt -y install postgresql
		```
	
	```
	# PostgreSQL 상태확인
	sudo systemctl status postgresql.service
	```
	출력 결과
	postgresql.service - PostgreSQL RDBMS
     Loaded: loaded (/usr/lib/systemd/system/postgresql.service; enabled; preset: enabled)
     Active: **active (exited)** since Mon 2024-05-13 04:19:05 UTC; 3min 34s ago
   Main PID: 24516 (code=exited, status=0/SUCCESS)
        CPU: 3ms

	May 13 04:19:05 ip-172-31-33-166 systemd[1]: Starting postgresql.service - PostgreSQL RDBMS...
	May 13 04:19:05 ip-172-31-33-166 systemd[1]: Finished postgresql.service - PostgreSQL RDBMS.
	```
	#PostgreSQL 실행 -> 탈출
	sudo -i -u postgres

	postgres@ip:~$ psql
	postgres=# \q
	postgres@ip:~$ exit
	```
	
	```
	~$ psql
	postgres=# \list 
	```
	
	```
	~$ createuser --interactive
	
	Enter name of role to add: testuser1
	Shall the new role be a superuser? (y/n) y
	```
	
	```
	# PostgreSQL role 목록 확인
	~$ psql
	postgres=# \du
	```
	
	```
	# PostgreSQL role 비밀번호 변경
	postgres=# ALTER USER postgres WITH PASSWORD 'postgres';
	```
	
	```
	# PostgreSQL 데이터베이스 생성
	postgres=# CREATE DATABASE ml;
	postgres=# \list
	```
	
	```
	# ml 데이터베이스로 연결
	postgres=# \c ml
	
	# pred_result라는 테이블 생성
	ml=# CREATE TABLE pred_result(
	id SERIAL PRIMARY KEY,
	input NUMERIC,
	output NUMERIC,
	insert_dt TIMESTAMP DEFAULT CURRENT_TIMESTAMP	
	);
	
	# 테이블 목록 조회
	ml=# \dt
	
	# pred_result 테이블 조회 (데이터가 없으므로 아무것도 조회 안됨)
	ml=# SELECT * FROM pred_result;
	```
	
	```
	# PostgreSQL 설정 파일 확인
	~$ cd /etc/postgresql/16/main/
	/etc/postgresql/16/main$ ll
	```
	
	```
	# PostgreSQL 외부 접속 허용
	sudo vim postgresql.conf
	:set nu (줄 번호 표시)
	:64 (64번 라인으로 이동)
	
	port = 5432
	
	:60 (60번 라인으로 이동)
	-> i (INSERT mode)
	60 #listen_addresses = 'localhost'
	-> 60 listen_addresses = '0.0.0.0'
	ESC -> :wq (저장하고 나가기)
	```
	
	```
	sudo vim pg_hba.conf
	
	:125
	host    all             all             127.0.0.1/32            scram-sha-256
	+ host    all             all             0.0.0.0/0            scram-sha-256
	
	-프로그램 수정 완료- (프로세스는 아님 재시작 해야함)
	```
	
	```
	# 재시작
	sudo systemctl restart postgresql
	# 실행 확인
	sudo systemctl status postgresql
	# 포트 열린거 확인
	netstat -nap | grep 5432
	```
	
	```
	# aws 인바운드 규칙
	+ 보안 그룹 규칙 유형 PostgreSQL -> 내 아이피/32 + 설명(ex.yeardream_sparkplus)
	```
	- NAT : 같은 조직의 IP 주소는 같다
	- 같은 건물이라도 다른 층, 다른 네트워크? 를 사용하면 접속 불가능 같다면 접속 가능
- ### shell script
	- 리눅스에서는 사용하는 쉘, bash를 더 많이 사용함
	- #!/bin/bash
		#는 일반적으로 주석으로 사용하지만 #!와 같이 느낌표가 함께 쓰이는 경우 셔뱅(shebang)이라고 부름
	```
	vim bashtest01.sh
	
	#!/bin/bash
	
	echo "Hello,World!"
	
	:wq
	```
	
	```
	chmod 777 bashtest01.sh
	
	bash bashtest01.sh
	
	Hello,World!
	```
	
	- 조건문
		```
		ubuntu@ip-172-31-3-55:~/work$ vim bashtest02.sh
		
		#!/bin/bash
		
		a=7
		echo "a is $a"
		if [ "$a" -gt 5 ]
		then
			echo "a is greater than 5"
		elif [ "$a" -gt 3 ]
		then
			echo "a is greater than 3"
		else
			echo "etc"
		fi
		
		chmod 777 bashtest02.sh
		bash bashtest02.sh
		(if_[_"$a"_-gt_5_] (언더바 자리에 띄워쓰기 필수!!))
		```
		- -eq : a == b (equal)
		- -ne : a != b (not equal)
		- -gt : a > b (greater than)
		- -lt : a < b (less than)
		- -ge : a >= b (greater than or equal)
		- -le : a <= b (less than or equal)
		- ! : !a (not)
	- 반복문
		```
		#!/bin/bash
		
		a=("abc" "def" "ghi")
		
		for element in ${a[@]}
		do
		    echo ${element}
		done
		```
	
	```
	# 파이썬 스크립트 실행
	cd
	vim .bashrc
	# 최 하단
	export PYENV_ROOT="$HOME/.pyenv"
	[[ -d $PYENV_ROOT/bin ]] && export PATH="$PYENV_ROOT/bin:$PATH"
	eval "$(pyenv init -)"
	eval "$(pyenv virtualenv-init -)"
	# 4줄 복사
	
	vim .profile
	# 최 하단에 붙여넣기
	
	# 쉘 재실행
	exec $SHELL
	```
	
	```
	# 파이썬 스크립트 실행
	#!/bin/bash
	
	# 스크립트 파일을 수정한 후에 수정된 값을 바로 적용하기 위해 사용하는 명령어
	source /home/ubuntu/.bashrc
	source /home/ubuntu/.profile
	
	pyenv activate py3_11_9
	
	cd /home/ubuntu/work
	
	# 그냥 실행
	python ./pytest02.py
	
	# 백그라운드로 실행
	#nohup python ./pytest02.py > /dev/null 2>&1 &
	
	pyenv deactivate
	```
	
	```
	# 권한 변경
	chmod 777 bashtest04.sh
	
	# 실행
	bash bashtest04.sh
	```
	
	```
	# 백그라운드 실행
	ps -ef | grep pytest02
	ubuntu     29982 ...
	
	# 종료
	kill -9 29982
	ubuntu     29982 (사라진거 확인)
	```
- ### **크론탭**
	- 리눅스 운영체제에서 배치 작업을 스케쥴링 하기 위한 프로그램 
	- 특정 시각에 작업 실행 하게 가능, 정기적인 작업 스케쥴링 가능
		- 00:00분 (자정) ~ 부터 크론탭 걸기 (다른부서 데이터가 00시에 업데이트 되서??)
	
	```
	# 크론탭 작동 여부 확인
	sudo service cron status
	```
	
	```
	# 크론탭 등록된 작업 확인
	crontab -l
	```
	
	마스터(결제 내역) - 슬레이브 (복제본) -> 이관하면 ip주소가 바뀜
		거기에 맞춰서 크론탭도 수정 해줘야함
	배치 : 데이터를 모아서 보낸다
		일배치 (하루치 데이터를 모아서), 시배치 (한시간 데이터를 모아서), 스트리밍 (데이터를 바로바로)
		![[Pasted image 20240514100716.png]]
	
	```
	# 크론탭 작업 등록
	crontab -e
	
	#처음 등록할 때는 에디터 선택
	1. /bin/nano
	2. /usr/bin/vim.basic
	3. /usr/bin/vim.tiny
	4. /bin/ed
	
	# 2 입력
	choose1-4 [1]:2
	```
	
	```
	date # 로 현재 시간 확인후
	crontab -e # 하고 최초에는 2번으로 설정 다음은 안뜸 그후 최하단에 아래 코드 작성
	
	# 크론탭 작업 등록
	SHELL=/bin/bash
	
	# 매일 매시간 매 24분 /home/ubuntu/work/bashtest04.sh을 실행
	24 * * * * source /home/ubuntu/work/bashtest04.sh
	# 사용후 주석 처리 필수!!
	```
	- #### 크론탭 * 의 의미
		- *               *                   *             *             *
		- 분(0-59)  시간(0-23)  일(1-31)  월(1-12)  요일 (0-7)
	```
	# 크론탭 실행 확인
	/work$ data
	Mon May 6 10:2#:59 UTC 2024
	
	# 실행 되기 전, 후 로 비교
	ps -ef | grep pytest
	
	# 종료
	kill -9 (포트번호)
	```
- ### 모니터링
	- df -h : 파일 시스템의 총 공간 및 사용 가능한 공간에 대한 정보를 표시
	- free -h : 메모리 (Swap 은 메모리가 부족할때 디스크를 메모리처럼 사용)