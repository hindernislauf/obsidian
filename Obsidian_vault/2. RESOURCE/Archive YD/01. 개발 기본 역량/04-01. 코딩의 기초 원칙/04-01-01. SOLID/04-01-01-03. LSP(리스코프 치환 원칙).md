# 3. LSP(Liskov Substitution Principle): 리스코프 치환 원칙

- 리스코프 치환 원칙이란, 부모 객체와 자식 객체가 있을 때 부모 객체를 호출하는 동작에서 자식 객체가 부모 객체를 완전히 대체할 수 있다는 원칙이다.
- 객체 지향 프로그래밍에서 상속이 일어나면, 하위 타입인 자식 객체는 상위 타입인 부모 객체의 특성을 가지며, 그 특성을 토대로 확장할 수 있다.

 ![[리스코프 치환 원칙.png]]
- 즉, 올바른 상속을 위해 자식 객체의 확장이 부모 객체의 방향을 온전히 따르도록 권고하는 원칙인 것이다.





아래 예제를 통해 리스코프 치환 원칙에 대해 알 수 있다.

---

## 3-1. LSP를 위반한 코드 예제

다음은 직사각형 `Rectangle`을 구현한 클래스다. 너비와 높이 값을 지정, 반환할 수 있으며 넓이를 계산할 수 있다.
```java
public class Rectangle {

    public int width;
    public int height;

    // 너비 반환, Width Getter
    public int getWidth() {
        return width;
    }
    // 너비 할당, Width Setter
    public void setWidth(int width) {
        this.width = width;
    }

    // 높이 반환, Height Getter
    public int getHeight() {
        return height;
    }
    // 높이 할당, Height Setter
    public void setHeight(int height) {
        this.height = height;
    }
    
    //직사각형 넓이 반환 함수
    public int getArea() {
    	return width * height;
    }
}
```

알다시피 정사각형은 직사각형의 범주에 포함된다. 그렇다면 직사각형을 상속하여 정사각형 객체를 만들면 정상적으로 작동하는지, 직사각형 클래스를 상속 받아 구현하는 실험을 진행해보자.

```java
public class Square extends Rectangle{
    
    @Override
    public void setWidth(int Width) {
        super.setWidth(width);
        super.setHeight(getWidth());
    }
    
    @Override
    public void setHeight(int height) {
        super.setHeight(height);
        super.setWidth(getHeight());
    }
    
}
```

위 코드처럼 `Rectangle` 객체를 상속 받은 `Square` 클래스에서는 정사각형의 너비와 높이가 같다는 특징을 구현했다. 너비와 높이 둘 중 하나를 입력해도 나머지 값이 일치되도록 메서드를 오버라이드 해주었다. 

```java
public class Main {
    public static void main(String[] args) {

        Rectangle rectangle = new Rectangle();
        rectangle.setHeight(5);
        rectangle.setWidth(10);

        System.out.println(rectangle.getArea());

    }
}
```

직사각형과 정사각형 클래스를 모두 구현해주었으니, 정상적으로 잘 작동하는지 확인하면 된다.

	50

`Rectangle` 클래스의 경우, Height 5 x Width 10인 직사각형의 길이가 정상적으로 잘 구해진 것을 확인할 수 있다.

---

이번에는 `Square` 클래스를 테스트해보자.

테스트에 앞서, 리스코프 치환 원칙은 부모 객체를 호출하는 동작에서 자식 객체가 부모 객체를 완전히 대체할 수 있다는 원칙임을 환기시킬 필요가 있다.

그렇다면, `Rectangle` 클래스에서의 테스트와 같은 값을 할당했을 때, 당연히 완전히 같은 결과를 반환해야 한다.

```java
public class Main {
    public static void main(String[] args) {

        Rectangle square = new Square();
        
        square.setWidth(10);
        square.setHeight(5);


        System.out.println(square.getArea());
        
    }
}
```

	25


왜 25가 반환되었을까? 스크립트에서 가장 마지막에 수행된 `setHeight(5)`가 객체의 너비와 높이를 모두 5로 할당했기 때문이다. 5 x 5로 계산되어 반환된 것이다.

사실 프로그램 자체는 기존의 계획대로, `정사각형의 넓이`가 잘 구현되었다. 하지만 `Rectangle` 클래스의 동작과 그를 상속 받은 `Square` 클래스의 동작이 전혀 다르다는 사실을 알 수 있다.

>이는 바로 정사각형이 직사각형을 상속받는 것이 올바른 상속 관계가 아니라는 것을 의미한다. 자식 객체가 부모 객체의 역할을 완전히 대체하지 못한다는 뜻이다.


---

## 3-2. LSP를 준수한 코드 예제

LSP를 위반한 코드를 통해 직사각형과 정사각형은 바람직한 상속 관계가 성립될 수 없다는 것을 알게 되었다. 올바르게 성립하는 상속 관계를 구현하기 위해, 더 큰 범주의 `사각형 객체`를 상속받을 수 있도록 구현해보자.

- `Shape 클래스` 구현

```java
public class Shape {

    public int width;
    public int height;

    // 너비 반환, Width Getter
    public int getWidth() {
        return width;
    }
    // 너비 할당, Width Setter
    public void setWidth(int width) {
        this.width = width;
    }

    // 높이 반환, Height Getter
    public int getHeight() {
        return height;
    }
    // 높이 할당, Height Setter
    public void setHeight(int height) {
        this.height = height;
    }

    // 사각형 넓이 반환
    public int getArea() {
        return width * height;
    }
}
```

```java

//직사각형 클래스
public class Rectangle extends Shape {

    public Rectangle(int width, int height) {
        setWidth(width);
        setHeight(height);
    }

}

//정사각형 클래스
public class Square extends Shape{
    
    public Square(int length) {
        setWidth(length);
        setHeight(length);
    }
    
}
```

- `Shape` 클래스를 상속 받는 `Rectangle` 클래스와 `Square` 클래스이다.

```java
public class Main {
    public static void main(String[] args) {
    
        Shape rectangle = new Rectangle(10, 5);
        Shape square = new Square(5);
        
        System.out.println(rectangle.getArea());
        System.out.println(square.getArea());
    }
}
```

	50  
	25

메인 메서드에서 테스트해보면, 값이 잘 나오는 것을 확인할 수 있다.  
더이상 `Rectangle` 객체와 `Square` 객체는 상속 관계가 아니므로, 리스코프 치환 원칙을 준수한다.


## 요약
	리스코프 치환 원칙은 상속되는 객체가 반드시 부모 객체를 완전히 대체할 수 있어야 한다고 권고한다.
