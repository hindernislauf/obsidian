# DRY(Don't Repeat Yourself)
: 반복(중복)되는 코드가 있으면 분리하라는 뜻이다.

```
"소프트웨어를 신뢰성 높게 개발하고, 개발을 이해하고 유지보수하기 쉽게 만드는 유일한 길은 우리가 DRY 원칙이라고 부르는 것을 따르는 것 뿐이라고 생각한다. DRY 원칙이란 이것이다. 모든 지식은 시스템 내에서 단일하고, 모호하지 않고, 정말로 믿을만한 표현 양식을 가져야 한다."

- 실용주의 프로그래머 -
```

## 중복의 4가지 범주(from 실용주의 프로그래머)

### 1) 강요에 의한 중복(Imposed duplication): 개발자들은 환경상의 문제로 중복을 피할 다른 대안이 없다고 생각한다.

프로젝트 표준에 의해서 중복된 정보가 기록된 문서를 요구하거나, 코드에 중복 정보가 생기는 문서를 요구하는 경우도 생긴다.

여러 플랫폼을 지원해야 하는 경우, 각각의 프로그래밍 언어 / 라이브러리 / 개발 환경이 필요하고, 여기서 공유된 Definition과 Procedure들이 중복된다. 간혹 프로그래밍 언어 자체가 중복된 정보 구조를 요구하는 경우도 있다.

#### (1) 정보의 다양한 표현 양식(Multiple representations of information)
- DB 테이블의 스키마를 그대로 반영하는 속성들을 가진 클래스가 필요하다고 한다면, 코드생성기(code generator)를 작성하는 것이 해답이다.
- 소프트웨어를 빌드할 때마다 간단한 코드생성기를 사용하여 메타데이터 표현에서 여러 개의 언어에 걸쳐 있는 구조를 만들어낼 수 있다.
#### (2) 코드 내의 문서화(Documentation in code)
- 코드에 '왜' 주석이 필요한지를 배우지 않으면, 나쁜 방식으로 주석을 달게 된다.
- DRY 원칙에서는 낮은 차원의 지식은 놔두고, 높은 차원의 지식에서 설명을 위해 주석을 아껴두라고 말한다.
- 낮은 차원의 지식 예시: dao.update(); 등에서 /*업데이트한다*/ 와 같은 주석
- 높은 차원의 지식 예시: /*요구 사항이 어떠했기 때문에 A행동과 B행동이 함께 실행되는 기능이 필요해 구현했다.*/ 와 같은 주석. ==> 개발자의 의도나 개발상 꼭 알아야 하는 것들.
- 즉, 주석과 코드의 의미가 동일하게 되면 그 또한 중복이 되는 것이다.
#### (3) 문서화와 코드(Documentation and code)
- 보통 문서를 작성하고 코드를 작성하는게 보편적인 방식이다.
- 하지만 긴박한 상황에서는 코드를 작성하고 문서를 갱신하지 않는 경험을 해보았을 것이다.
- 뭔가 설명이 부족해서 추가 타이핑 필요함

#### (4) 언어에 관한 문제(Language issues)
- 많은 언어가 소스코드에 상당한 양의 중복을 강요한다. 언어가 모듈의 인터페이스와 구현을 분리하는 경우에 이런 일이 자주 생긴다.
- Java에서 interface와 implement된 class를 생각하면 된다.
- 두 개의 파일에 걸쳐 주석을 중복할 필요는 없다. 인터페이스 부분에서의 주석은 약속에 대한 것을 적으면 된다. 구현된 곳에서는 구현에 관련한 주석을 달면 된다.

### 2)부주의한 중복(Inadvertent duplication): 개발자들은 자신들이 정보를 중복하고 있다는 것을 깨닫지 못한다.
- 말 그대로 설계 실수의 결과로 나타나기도 한다는 것이다.
### 3)참을성 없는 중복: 중복이 쉬워 보이기 때문에 개발자들이 게을러져서 중복을 하게 된다.
- 시간의 압박을 받을 때 기존의 소스를 복사 + 붙여넣기하고, 조금만 수정하는 형태로 일을 하는 경우가 있다.
- Y2K 사태를 '날짜 필드의 크기를 매개 변수로 만들지 않았거나 날짜 서비스를 하나의 라이브러리에 집중해 구현하지 않으려는 개발자들의 게으름에 의해 일어난 것'이라는 주장으로 생각할 수 있다.

### 4)개발자간의 중복: 한 팀, 또는 다른 팀에 있는 여러 사람들이 동일한 정보를 중복한다.

어떤 면에서 보면 발견하거나 다루기 가장 어려운 유형의 중복이다. 전체 기능 집합이 부주의하게 중복될 수도 있고, 수년 동안 발견되지 않을 수도 있으며, 결국에는 유지보수 문제로 귀결될 수 있다.

1. 설계의 깔끔함과 강력하고 기술적인 PO
2. 설계 내에서 책임의 분배가 제대로 이해되도록 하는 것

이론적이고 추상적이지만, 이렇게 개발자 간의 중복 문제를 다룰 수 있다.


# WET: DRY 원칙 위반

```
We Enjoy Typing!
Write Everything Twice!
Waste Everyone's Time!
```

---




## 참고
- 이 원칙을 무작정 지키려다보면 문제가 되는 경우도 있다.
- 예를 들어, 아래 코드에서 Array.map 함수가 반복되는 것을 발견해서 DRY 원칙에 따라 분리하려 한다.

``` java
function processList(items, action) { 
	return items.map(item => action(item)); 
} 

const numbers = [1, 2, 3, 4, 5]; 
const double = num => num * 2; 
const doubledNumbers = processList(numbers, double); 

const strings = ["apple", "banana", "cherry"]; 
const uppercasedStrings = processList(strings, str => str.toUpperCase());

```

- 위 코드를 리뷰하자면 문제점이 존재한다.
- map은 자바스크립트 자체에서 제공하는 함수이다.
- 하지만 processList로 map을 추상화했고, 작성자만 알 수 있는 코드가 되었다.
- processList에서 추상화한 내용을 무시하고 map을 사용하다 보면, 같은 map이 다른 형태로 혼용되게 된다.
- 이런 경우에는 콜백 함수에 타입을 추가적으로 지정하여 굳이 필요없는 코드가 계속 늘어나게 된다.

DRY 원칙을 사용하려면 다음 항목들을 고려해보는 것이 좋다.

```
- 재사용 가능성이 높은가?
- 유틸성이 강하면서 작은 단위인가(포맷팅 등)?
- 비슷한 내용들을 한 파일에서 관리하는 게 더 좋지 않은가?
- 설정에 관련된 부분인가?
```

만약 코드에서 분리를 직접 하거나 팀원들에게 분리를 권유하고 싶을 때에는 다음과 같이 소통할 수 있다.

```
날짜 형식의 문자열을 포맷팅하는 코드는 유틸성이 강하고 재사용성이 높으므로, 작은 단위로 분리하여 관련 파일이 있는 곳으로 이동시키면 필요한 함수가 이미 존재하는지 확인하기 좋을 것 같습니다.
```