# 1. 스레드
## 중요도 🥇

: 프로세스는 한 개 이상의 **스레드(thread)** 를 갖는데, 스레드는 프로세스에서 실제로 실행되는 흐름의 단위를 의미한다. 


스레드는 아래 그림처럼 프로세스 안에 존재하므로 프로세스의 메모리 공간을 이용하고, 지역 변수를 저장하는 스택 영역을 할당받는다. 그리고 전역 변수를 저장하는 힙 영역은 다른 스레드와 공유한다.


![](https://i.imgur.com/hvSIQeZ.png)
(그림) 운영 체제에서 프로세스와 스레드의 구조. 운영 체제 아래 이러한 프로세스들이 병존한다.

---
### 깊게 알기: 사용자 레벨 스레드 / 커널 레벨 스레드
[[00-02-00-02. 커널과 시스템 콜]] 에서, 커널에서 관리하는 자원을 보호하기 위해 내부적으로 **사용자 모드**와 **커널 모드**로 구분한다고 했다. 마찬가지로 스레드 또한 스레드를 관리하는 주체에 따라 구분된다.

![](https://i.imgur.com/UhkAIwu.png)
(그림) 사용자 스레드와 커널 스레드

- 사용자 레벨 스레드(user-level thread)는 사용자가 라이브러리를 이용해 생성 및 관리한다.
- 커널 레벨 스레드(kernel-level thread)는 커널이 스레드를 생성 및 관리한다.

멀티 스레드 환경에서 사용자 레벨 스레드와 커널 레벨 스레드는 다음과 같이 3가지 관계를 맺을 수 있다.

#### 1. 다대일 모델(many-to-one model)
![](https://i.imgur.com/iJa47Mi.png)
(그림) 다대일 모델

사용자 공간(레벨)의 스레드 n개에, 커널 공간 스레드 1개가 매핑되어 사용자 레벨에서 스레드를 관리한다. **하나의 사용자 레벨 스레드에서 시스템 콜을 호출하면 나머지 사용자 레벨 스레드는 커널 레벨에 접근할 수 없으므로 멀티 코어의 병렬성을 이용할 수 없다**.

#### 2. 일대일 모델(one-to-one model)

![](https://i.imgur.com/wmr54zL.png)
(그림) 일대일 모델

사용자 공간 스레드 1개당 커널 공간 스레드 1개가 매핑된다. 다대일 모델의 경우에는 하나의 사용자 공간 스레드에서 시스템 콜을 호출하면 다른 사용자 공간 스레드가 모두 실행되지 않는 단점이 있는데, 일대일 모델로 그것을 해결할 수 있다. 하지만 **사용자 레벨 스레드의 수만큼 커널 레벨 스레드가 생성되기 때문에 성능 저하**가 일어날 수 있다.

#### 3. 다대다 모델(many-to-many model)

![](https://i.imgur.com/MSv8hUR.png)
(그림) 다대다 모델

사용자 공간 스레드 n개에 커널 레벨 스레드 m개가 매핑된다. 이 때 커널 공간 스레드의 수(m)는 사용자 공간 스레드의 수(n)보다 적거나 같다. 다대다 모델은 다대일 모델과 일대일 모델의 장점만을 가지고 있지만, 구현이 어렵다는 단점이 있다.


